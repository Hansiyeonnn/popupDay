<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="flower.popupday.business.dao.StatsDAO">

    <resultMap id="visitResult" type="statsDTO">
        <result property="hits_id" column="hits_id"/>
        <result property="user_id" column="user_id"/>
        <result property="popup_id" column="popup_id"/>
        <result property="viewed_at" column="viewed_at"/>
    </resultMap>

<!--    <select id="statsList" parameterType="long">-->
<!--        select * from hits_tbl where popup_id = #{popup_id}-->
<!--    </select>-->

    <select id="statsCount" parameterType="long" resultType="HitsDTO">
        SELECT DATE_FORMAT(viewed_at, '%Y-%m') AS month, COUNT(*) AS hit_count
        FROM hits_tbl WHERE popup_id = #{popup_id}
        GROUP BY month ORDER BY month;
    </select>
</mapper>