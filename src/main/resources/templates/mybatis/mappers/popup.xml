<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="flower.popupday.popup.dao.PopupDAO">

    <resultMap type="popupDTO" id="popResult">
        <id property="popupId" column="popup_id"/>
        <result property="title" column="title"/>
        <result property="info" column="info"/>
        <result property="time" column="time"/>
        <result property="content" column="content"/>
        <result property="map" column="map"/>
        <result property="brandPage" column="brand_page"/>
        <result property="role" column="role" />
        <result property="userId" column="user_id"/>
    </resultMap>

    <resultMap type="imageDTO" id="imgResult">
        <result property="popup_image_id" column="popup_image_id"/>
        <result property="popup_id" column="popup_id"/>
        <result property="image_file_name" column="image_file_name"/>
    </resultMap>

    <!-- 팝업 id를 가지고 특정 정보 -->
    <select id="getPopupById" parameterType="long" resultMap="PopupMap">
        SELECT * FROM popup WHERE popup_id = #{popupId}
    </select>

    <!-- 모든 팝업 정보 -->
    <select id="getAllPopups" resultMap="PopupMap">
        SELECT * FROM popup
    </select>

    <!-- 팝업 등록 -->
    <insert id="insertPopup" parameterType="flower.popupday.popup.dto.PopupDTO" useGeneratedKeys="true" keyProperty="popupId">
        INSERT INTO popup (title, info, time, content, map, brand_page, role, user_id)
        VALUES (#{title}, #{info}, #{time}, #{content}, #{map}, #{brandPage}, #{role}, #{userId})
    </insert>

    <!-- 팝업 글번호로 해당 팝업 글 업데이트 -->
    <update id="updatePopup" parameterType="flower.popupday.popup.dto.PopupDTO">
        UPDATE popup
        SET title = #{title}, info = #{info}, time = #{time}, content = #{content}, map = #{map}, brand_page = #{brandPage}, role = #{role}, user_id = #{userId}
        WHERE popup_id = #{popupId}
    </update>

    <!-- 팝업 글번호로 해당 팝업 글 삭제 -->
    <delete id="deletePopup" parameterType="long">
        DELETE FROM popup WHERE popup_id = #{popupId}
    </delete>

</mapper>
