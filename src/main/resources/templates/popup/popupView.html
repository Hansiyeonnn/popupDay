<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="layout/layout">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" th:href="@{/css/popupView.css}">
    <link rel="stylesheet" th:href="@{/css/popupListMap.css}">
    <script src="https://code.jquery.com/jquery-latest.min.js"></script>
    <title>팝업상세페이지</title>
</head>
<body>
<th:block layout:fragment="content">
    <div class="body">
        <div class="containers">
            <!--팝업 상세페이지-->
            <div class="popupdetail">

                <!-- 팝업 이미지 슬라이드 -->
                <div class="popupdetail-wrap" th:if="${not #strings.isEmpty(popupMap.imageFileList)}">
<!--                    imageFileList가 비어있지 않은 경우에만 이 div 표시-->
                    <article class="main-article">
                        <div class="popupdetail-banner" th:each="imgList, status : ${popupMap.imageFileList}">
<!--                            imageFileList의 각 항목에 대해 반복문을 돌림-->
                            <td>
                                <input type="hidden" th:name="'originalFileName' + ${status.count}" th:value="${imgList.image_file_name}"> <!-- 이름이 하나로 고정 -->
                                <input type="hidden" th:name="'image_file_name' + ${status.count}" th:value="${imgList.popup_image_id}"> <!-- 파일 번호가져감 -->
                                <img th:id="'preview' + ${status.count}" th:src="@{/popupDownload.do(popup_id=${imgList.popup_id},image_file_name=${imgList.image_file_name})}" width="200">
<!--                                이미지 표시, 각 이미지에 대해 고유한 id를 부여하고 src에 이미지 파일 경로를 할당-->
                            </td>
                        </div>
                    </article>
                </div>

                <!-- 팝업 정보 -->
                <div class="popupdetail-inner">
                    <!-- 상세보기된 팝업 정보 -->
                    <div class="popupdetail-title-infor">
                        <div class="popup-title">
                            <div>
                                <input type="text" th:value="${popupMap.popupList.user_nikname}" disabled>
                                <input class="tit" type="text" th:name="title" th:value="${popupMap.popupList.title}" disabled>
                            </div>
                            <button id="heart-icon" th:data-login-check="${loginCheck}">
                                <img id="heart-image" class="heart"
                                     th:src="${loginCheck ? (popupMap.isLiked ? '/images/heart_fill.svg' : '/images/heart_empty.svg') : '/images/heart_empty.svg'}"
                                     th:data-popup-id="${popupMap.popupList.popup_id}" alt="찜">
                            </button>
                        </div>
<!--                        <img id="heart-image" class="heart" th:data-popup-id="${popupMap.popupList.popup_id}" th:src="@{/images/heart_empty.svg}" alt="찜">-->
                        <div class="date">
                            <img th:src="@{/images/date.svg}" alt="달력">
                            <p th:text="${popupMap.popupList.start_date} + ' ~ ' + ${popupMap.popupList.end_date}"></p>
                        </div>

                        <div class="location">
                            <img th:src="@{/images/location.svg}" alt="위치">
                            <input type="text" th:name="address"  th:value="${popupMap.popupList.address}" disabled>
                        </div>

                        <div class="abc">
                            <span class="search-box-inner" th:each="hash, status : ${popupMap.hashTagList}">
                                <input id="tag" type="text" th:name="hash_tag" th:value="${hash.hash_tag}" disabled oninput="adjustWidth(this)">
                            </span>
                        </div>
                        <div class="popup-Icon">
                            <img class="eye" th:src="@{/images/eye.svg}" alt="조회수눈">
                            <p th:text="${popupMap.popupList.hits}" class="hits"></p>
                            <a th:href="${main}"><img class="send" th:src="@{/images/send.svg}" alt="보내기"></a> <!-- 카카오 보내기 혹은 url-->
                        </div>
                    </div>
                </div>

                <!--주차 입장료 여부-->
                <div class="popupdetail-icon-area">
                    <div class="parking">
                        <img th:src="${popupMap.popupList.parking == '주차가능' ? '/images/parking.jpg' : '/images/unparking.jpg'}" alt="주차">
                        <p th:text="${popupMap.popupList.parking}"></p>
                    </div>
                    <div class="ticket">
                        <img th:src="${popupMap.popupList.fee == '입장비무료' ? '/images/ticket.svg' : '/images/ticket.svg'}" alt="입장료">
                        <p th:text="${popupMap.popupList.fee}"></p>
                    </div>
                </div>

                <!-- 운영시간 -->
                <div class="popupdetail-time">
                    <div class="popup-time">
                        <a class="popupdetail-total">
                            <h3 class="infor-tit">운영시간</h3>
                            <a><img id="toggle0" class="open" th:src="@{/images/angle-down-solid.svg}" alt="아래화살표"></a>
                        </a>
                    </div>
                    <div class="answer" style="display: none;">
                        <div>
                            <label for="monday_time">월:</label>
                            <input type="text" id="monday_time" th:name="monday_time" th:value="${popupMap.popupList.monday_time}" disabled>
                        </div>
                        <div>
                            <label for="tuesday_time">화:</label>
                            <input type="text" id="tuesday_time" th:name="tuesday_time" th:value="${popupMap.popupList.tuesday_time}" disabled>
                        </div>
                        <div>
                            <label for="wednesday_time">수:</label>
                            <input type="text" id="wednesday_time" th:name="wednesday_time" th:value="${popupMap.popupList.wednesday_time}" disabled>
                        </div>
                        <div>
                            <label for="thursday_time">목:</label>
                            <input type="text" id="thursday_time" th:name="thursday_time" th:value="${popupMap.popupList.thursday_time}" disabled>
                        </div>
                        <div>
                            <label for="friday_time">금:</label>
                            <input type="text" id="friday_time" th:name="friday_time" th:value="${popupMap.popupList.friday_time}" disabled>
                        </div>
                        <div>
                            <label for="saturday_time">토:</label>
                            <input type="text" id="saturday_time" th:name="saturday_time" th:value="${popupMap.popupList.saturday_time}" disabled>
                        </div>
                        <div>
                            <label for="sunday_time">일:</label>
                            <input type="text" id="sunday_time" th:name="sunday_time" th:value="${popupMap.popupList.sunday_time}" disabled>
                        </div>
                    </div>
                </div>

                <!-- 팝업스토어 소개글 -->
                <div class="popupdetail-info-inner">
                    <h3 class="infor-tit">팝업 상세 정보</h3>
                    <input type="text" th:name="content"  th:value="${popupMap.popupList.content}" disabled>
                </div>

                <!--안내및주의사항-->
                <div class="popupdetail-caution">
                    <h3 class="infor-tit">안내 및 주의사항</h3>
                    <input type="text" th:name="info"  th:value="${popupMap.popupList.info}" disabled>
                </div>

                <!--오시는길-->
                <div class="popupdetail-map">

                    <h3 class="infor-tit">오시는 길</h3>
                    <article class="map-area-wrap">
                        <div class="map-area">
                            <input type="text" th:name="address" th:value="${popupMap.popupList.address}" disabled>
                        </div>
                    </article>
                    <ul>
                        <li><p th:value="${popupMap.popupList.address}"></p></li>
                        <li><button type="button">주소복사</button></li>
                    </ul>
                </div>
                <!--주변 카페 및 놀거리-->
                <div class="popupdetail-play">
                    <a class="popupdetail-total">
                        <h3 class="infor-tit">주변 카페 및 놀거리</h3>
                        <img id="toggle1" class="open" th:src="@{/images/angle-down-solid.svg}" alt="아래화살표">
                    </a>
                    <div class="map_wrap answer" style="display: none">
                        <div id="map" style="width:500px;height:300px;position:relative;overflow:hidden;"></div>

                        <div id="menu_wrap" class="bg_white">
                            <div class="option" >
                                <div>
                                    <form onsubmit="searchPlaces(); return false;">
                                        키워드 : <input type="text" value="이태원 맛집" id="keyword" size="15">
                                        <button type="submit">검색하기</button>
                                    </form>
                                </div>
                            </div>
                            <hr>
                            <ul id="placesList"></ul>
                            <div id="pagination"></div>
                        </div>
                    </div>
                </div>

                <!--리뷰-->
                <div class="popupdetail-review">
                    <a class="popupdetail-total" th:href="@{/notice/reviewList.do}">
                        <h3 class="infor-tit">리뷰 작성하기</h3>
                    </a>
                </div>
            </div>
        </div>
    </div>
    </div>
    </div>
    <script th:src="@{/js/jquery-3.7.1.min.js}"></script>
    <script th:src="@{/js/jquery-ui.min.js}"></script>
    <script th:src="@{https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js}" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
    <script th:src="@{https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js}" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
    <script th:src="@{/js/main.js}"></script>
    <script th:src="@{/js/search.js}"></script>
    <script th:src="@{/js/boardDetail.js}"></script>
    <script type="text/javascript" th:src="@{'//dapi.kakao.com/v2/maps/sdk.js?appkey=089d852b497e6c513c79b8561670e3a0&libraries=services,clusterer,drawing'}"></script>
    <script th:src="@{/js/popupListMap.js}"></script>
    <script th:src="@{/js/popupView.js}"></script>
    <script>
        var script = document.createElement('script');
        script.src = 'https://example.com/script.js';
        script.async = true; // 또는 script.defer = true;
        document.head.appendChild(script);
    </script>
</th:block>
</body>
</html>